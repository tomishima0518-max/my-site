<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>å®Œå…¨ç‰ˆMAXã‚²ãƒ¼ãƒ  Firebaseç‰ˆ</title>
<style>
body { font-family: Arial; margin:0; padding:0; background:#111; color:#eee; }
header { padding:10px; background:#222; text-align:center; }
.tabs { display:flex; justify-content:center; gap:10px; margin:10px 0; flex-wrap:wrap; }
.tabs button { padding:10px 20px; cursor:pointer; background:#333; color:#eee; border:none; border-radius:5px; margin:2px;}
.tabs button.active { background:#0af; }
.game-card { display:none; padding:20px; text-align:center; }
.rank { text-align:left; max-height:200px; overflow-y:auto; margin-top:10px; }
#youtubeFrame { width:100%; height:200px; margin:10px 0; border:none; }
#gauge { width:80%; height:20px; background:#333; margin:10px auto; border-radius:10px; overflow:hidden; }
#gaugeFill { width:0%; height:100%; background:#0f0; transition:width 0.01s linear; }
input { padding:5px; text-align:center; width:100px; }
button { margin:5px; padding:5px 10px; cursor:pointer; background:#0af; color:#fff; border:none; border-radius:5px; }
#timeDisplay { font-size:28px; color:red; margin:10px 0; }
</style>
<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

<header>
  <h1>å®Œå…¨ç‰ˆMAXã‚²ãƒ¼ãƒ  Firebaseç‰ˆ</h1>
  <div id="youtubeFrameContainer">
    <iframe id="youtubeFrame" src="https://www.youtube.com/embed/?listType=user_uploads&list=UCmZY34Ev1I5FIcDC5tdXeDg" allowfullscreen></iframe>
  </div>
  <div id="gauge"><div id="gaugeFill"></div></div>
</header>

<div class="tabs">
  <button onclick="switchGame(1)" class="active">20ç§’é€£æ‰“</button>
  <button onclick="switchGame(2)">DOORSé¢¨è„±å‡º</button>
  <button onclick="switchGame(3)">æ”¾ç½®ç³»</button>
  <button onclick="switchGame(4)">ã‚¯ã‚¤ã‚º/çµŒå–¶</button>
  <button onclick="switchGame(5)">ç®—æ•°ã‚²ãƒ¼ãƒ </button>
</div>

<!-- å„ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢çœç•¥ï¼ˆå…ˆã»ã©ã®æ§‹é€ ã¨åŒã˜ï¼‰ -->
<div id="game1" class="game-card" style="display:block">
  <h3>20ç§’é€£æ‰“ã‚²ãƒ¼ãƒ </h3>
  <div>ã‚¹ã‚³ã‚¢ï¼š<span id="score1">0</span></div>
  <button onclick="clickGame1()">é€£æ‰“ï¼</button>
  <div id="feedback1"></div>
  <h4>ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h4>
  <div id="myRank1"></div>
  <ol id="rank1" class="rank"></ol>
</div>
<div id="game2" class="game-card">
  <h3>DOORSé¢¨è„±å‡ºã‚²ãƒ¼ãƒ </h3>
  <p>ç°¡å˜ãªã‚¯ãƒªãƒƒã‚¯ã§è„±å‡ºã‚²ãƒ¼ãƒ </p>
  <button onclick="doorsNext()">æ¬¡ã®éƒ¨å±‹ã¸</button>
  <div id="feedback2"></div>
  <h4>ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h4>
  <div id="myRank2"></div>
  <ol id="rank2" class="rank"></ol>
</div>
<div id="game3" class="game-card">
  <h3>æ”¾ç½®ç³»ã‚¯ãƒªãƒƒã‚«ãƒ¼</h3>
  <div>ã‚¹ã‚³ã‚¢ï¼š<span id="score3">0</span></div>
  <button onclick="clickGame3()">ã‚¯ãƒªãƒƒã‚¯ã§å¢—åŠ </button>
  <div id="feedback3"></div>
  <h4>ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h4>
  <div id="myRank3"></div>
  <ol id="rank3" class="rank"></ol>
</div>
<div id="game4" class="game-card">
  <h3>ã‚¯ã‚¤ã‚º/çµŒå–¶ç³»ã‚²ãƒ¼ãƒ </h3>
  <div id="quizQuestion">å•é¡ŒãŒã“ã“ã«å‡ºã¾ã™</div>
  <input type="text" id="quizAnswer" placeholder="ç­”ãˆã‚’å…¥åŠ›">
  <button onclick="submitQuiz()">å›ç­”</button>
  <div id="feedback4"></div>
  <div>ã‚¹ã‚³ã‚¢ï¼š<span id="score4">0</span></div>
  <h4>ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h4>
  <div id="myRank4"></div>
  <ol id="rank4" class="rank"></ol>
</div>
<div id="game5" class="game-card">
  <h3>ğŸ§® ãƒãƒ—ãƒªãƒ¼ã‚°ç®—æ•°ãƒãƒ£ãƒ¬ãƒ³ã‚¸</h3>
  <div>HPï¼š<span id="hp">300</span></div>
  <div>ã‚¹ã‚³ã‚¢ï¼š<span id="score">0</span></div>
  <div id="timeDisplay"></div>
  <div id="question"></div>
  <input type="number" id="answer" placeholder="ç­”ãˆã‚’å…¥åŠ›">
  <button onclick="submitAnswer()">å›ç­”</button>
  <div id="feedback"></div>
  <h4>ğŸ† ç®—æ•°ã‚²ãƒ¼ãƒ ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h4>
  <div id="myRank_arith"></div>
  <ol id="rank_arith" class="rank"></ol>
</div>

<script>
/* =========================
   Firebase åˆæœŸåŒ–
   ========================= */
const firebaseConfig = {
  apiKey: "AIzaSyXXXXX",
  authDomain: "ryutengame.firebaseapp.com",
  databaseURL: "https://ryutengame-default-rtdb.firebaseio.com",
  projectId: "ryutengame",
  storageBucket: "ryutengame.appspot.com",
  messagingSenderId: "1234567890",
  appId: "1:1234567890:web:abcdef123456"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

/* =========================
   ã‚¿ãƒ–åˆ‡æ›¿
   ========================= */
let currentGame = 1;
function switchGame(num){
  for(let i=1;i<=5;i++){
    document.getElementById(`game${i}`).style.display = i===num ? "block" : "none";
    document.querySelectorAll(".tabs button")[i-1].classList.toggle("active", i===num);
  }
  currentGame = num;
}

/* =========================
   â˜… ã‚²ãƒ¼ãƒ ã‚¹ã‚³ã‚¢ Firebase ä¿å­˜ï¼å–å¾—é–¢æ•°
   ========================= */
function saveScore(gameKey, score){
  const name = localStorage.name || prompt("åå‰"); localStorage.name=name;
  db.ref(`rankings/${gameKey}`).push({name, score});
}
function getRank(gameKey, rankElId, myRankElId){
  db.ref(`rankings/${gameKey}`).orderByChild('score').limitToLast(150).once('value', snapshot => {
    const r = [];
    snapshot.forEach(child => r.push(child.val()));
    r.sort((a,b)=>b.score-a.score);
    const rankEl = document.getElementById(rankElId);
    const myRankEl = document.getElementById(myRankElId);
    rankEl.innerHTML="";
    r.forEach((d,i)=>{
      const li = document.createElement("li");
      li.textContent=`${i+1}ä½ ${d.name} : ${d.score}`;
      rankEl.appendChild(li);
      if(d.name===localStorage.name) myRankEl.textContent=`ã‚ãªãŸï¼š${i+1}ä½ï½œ${d.score}ç‚¹`;
    });
  });
}

/* =========================
   â˜… å„ã‚²ãƒ¼ãƒ ç°¡æ˜“å®Ÿè£…
   ========================= */
// 20ç§’é€£æ‰“
let score1=0; function clickGame1(){ score1++; document.getElementById("score1").textContent=score1; }
function saveRank1(){ saveScore('game1', score1); getRank('game1','rank1','myRank1'); }

// DOORSé¢¨
let doorsRoom=1; function doorsNext(){ doorsRoom++; document.getElementById("feedback2").textContent=`éƒ¨å±‹${doorsRoom}ã«é€²ã‚“ã ï¼`; }
function saveRank2(){ saveScore('game2', doorsRoom); getRank('game2','rank2','myRank2'); }

// æ”¾ç½®ç³»
let score3=0; setInterval(()=>{ score3+=1; document.getElementById("score3").textContent=score3; },1000);
function clickGame3(){ score3+=5; document.getElementById("score3").textContent=score3; }
function saveRank3(){ saveScore('game3', score3); getRank('game3','rank3','myRank3'); }

// ã‚¯ã‚¤ã‚º
let score4=0; const quizData=[{q:"1+1=?", a:"2"},{q:"2*3=?", a:"6"},{q:"10-4=?", a:"6"}]; let quizIndex=0;
function showQuiz(){ document.getElementById("quizQuestion").textContent=quizData[quizIndex].q; }
function submitQuiz(){ const ans=document.getElementById("quizAnswer").value;
if(ans===quizData[quizIndex].a){ score4+=10; document.getElementById("feedback4").textContent="æ­£è§£ï¼ï¼‹10ç‚¹"; }
else { document.getElementById("feedback4").textContent="ä¸æ­£è§£ï¼"; }
document.getElementById("score4").textContent=score4;
quizIndex=(quizIndex+1)%quizData.length; document.getElementById("quizAnswer").value=""; showQuiz();}
function saveRank4(){ saveScore('game4', score4); getRank('game4','rank4','myRank4'); }
showQuiz();

// ç®—æ•°ã‚²ãƒ¼ãƒ 
let hp=300; let score5=0; let timeLeft=10; let timerInterval;
const RANK_KEY_ARITH="game5";
function newQuestion(){ 
  const levels=[{name:"ç°¡å˜",point:75,damage:5},{name:"æ™®é€š",point:100,damage:7.5},{name:"é›£",point:140,damage:10},{name:"é¬¼",point:190,damage:15},{name:"ãƒœã‚¹",point:250,damage:30}];
  const level=levels[Math.floor(Math.random()*levels.length)];
  const a=Math.floor(Math.random()*(level.point/10+1))+1;
  const b=Math.floor(Math.random()*(level.point/10+1))+1;
  const op=["+","-","*"][Math.floor(Math.random()*3)];
  const questionText=`${a} ${op} ${b}`;
  const answerValue=eval(questionText);
  const qEl=document.getElementById("question");
  qEl.textContent=`${level.name}ï¼š ${questionText} = ?`;
  qEl.dataset.answer=answerValue; qEl.dataset.point=level.point; qEl.dataset.damage=level.damage;
  document.getElementById("answer").value="";
  timeLeft=10; document.getElementById("timeDisplay").textContent="";
  clearInterval(timerInterval);
  timerInterval=setInterval(()=>{
    timeLeft-=0.01;
    if(timeLeft<=3 && timeLeft>0){ document.getElementById("timeDisplay").textContent=timeLeft.toFixed(2); }
    else if(timeLeft<=0){ clearInterval(timerInterval); wrongAnswer(); }
  },10);
}
function submitAnswer(){ const qEl=document.getElementById("question");
const ans=Number(document.getElementById("answer").value);
const correct=Number(qEl.dataset.answer);
if(ans===correct){ score5+=Number(qEl.dataset.point); document.getElementById("feedback").textContent=`æ­£è§£ï¼ï¼‹${qEl.dataset.point}ãƒã‚¤ãƒ³ãƒˆ`; }
else { wrongAnswer(); return; }
updateStatus(); newQuestion();
}
function wrongAnswer(){ const qEl=document.getElementById("question");
hp-=Number(qEl.dataset.damage); document.getElementById("feedback").textContent=`ä¸æ­£è§£ï¼ï¼${qEl.dataset.damage}HP`;
updateStatus(); if(hp<=0){ document.getElementById("feedback").textContent=`ã‚²ãƒ¼ãƒ ã‚ªãƒ¼ãƒãƒ¼ï¼æœ€çµ‚ã‚¹ã‚³ã‚¢ï¼š${score5}`; clearInterval(timerInterval); saveArithScore(); return; } newQuestion();
}
function updateStatus(){ document.getElementById("hp").textContent=hp; document.getElementById("score").textContent=score5; document.getElementById("timeDisplay").textContent=""; }
function saveArithScore(){ saveScore(RANK_KEY_ARITH, score5); getRank(RANK_KEY_ARITH,'rank_arith','myRank_arith'); }
newQuestion();

/* =========================
   â˜… 20ç§’ã‚²ãƒ¼ã‚¸ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
   ========================= */
let gaugeWidth=0;
setInterval(()=>{ gaugeWidth+=0.5; if(gaugeWidth>100) gaugeWidth=0; document.getElementById("gaugeFill").style.width=gaugeWidth+"%"; },100);
</script>

</body>
</html>
