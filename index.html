<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>登録者数ゲージ</title>
  <style>
    #bar {
      width: 300px;
      height: 20px;
      background: #ddd;
      border-radius: 10px;
      overflow: hidden;
    }
    #subBar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #ff0000, #ff9900);
      transition: width 0.5s;
    }
  </style>
</head>
<body>

<h2 id="subCount">読み込み中…</h2>

<div id="bar">
  <div id="subBar"></div>
</div>

<script>
  const API_KEY = "AIzaSyCrvwE11RwAJm5_MsUAkcZ_WQECJehcLRY";
  const CHANNEL_ID = "UCmZY34Ev1I5FIcDC5tdXeDg";
  const GOAL = 1000;

  function fetchSubscribers() {
    fetch(`https://www.googleapis.com/youtube/v3/channels?part=statistics&id=${CHANNEL_ID}&key=${API_KEY}`)
      .then(res => res.json())
      .then(data => {
        const subs = Number(data.items[0].statistics.subscriberCount);
        const percent = Math.min((subs / GOAL) * 100, 100);

        document.getElementById("subBar").style.width = percent + "%";
        document.getElementById("subCount").textContent =
          `現在 ${subs.toLocaleString()} 人 / 目標 ${GOAL} 人`;
      })
      .catch(err => {
        document.getElementById("subCount").textContent = "取得エラー";
        console.error(err);
      });
  }

  // 初回実行
  fetchSubscribers();

  // ★ 1秒ごとに自動更新（1000ms = 1秒）
  setInterval(fetchSubscribers, 300000);
</script>

</body>
</html>
